{"version":3,"sources":["views/admin/page/PageList.js"],"names":["REACT_APP_BASE_URL","require","default","PageList","props","componentDidMount","Axios","get","then","r","console","log","setState","list","data","state","window","open","id","this","history","push","page","host","replace","url","item","swal","title","text","icon","buttons","dangerMode","willDelete","delete","filter","JSON","parse","stringify","Date","getTime","post","e","className","type","size","color","onClick","onExport","name","map","date","moment","createdAt","format","key","visit","page_users","length","variant","onVisit","onView","onDownload","onEdit","onHtmlEdit","onDelete","onDuplicate","Component"],"mappings":"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","file":"static/js/22.9a3965e0.chunk.js","sourcesContent":["import React, { Component } from 'react'\nimport {\n  CButton,\n  CCard,\n  CCardBody,\n  CCardHeader,\n  CCol,\n  CRow,\n} from '@coreui/react'\nimport swal from 'sweetalert';\nimport CIcon from '@coreui/icons-react'\n\nimport * as moment from 'moment'\nimport Axios from '../../../lib/api';\n\n\nconst REACT_APP_BASE_URL = require('../../../lib/env').default;\n\nclass PageList extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      list: []\n    }\n  }\n  componentDidMount = () => {\n    Axios.get('admin/page/pages').then(r => {\n      console.log(r)\n      this.setState({ list: r.data })\n    })\n  }\n  onExport() {\n    window.open(`${REACT_APP_BASE_URL}/admin/page/pages-export`, '_blank');\n  }\n  onView(id) {\n    this.props.history.push(`/view/${id}`);\n  }\n  onVisit(page) {\n    var host = REACT_APP_BASE_URL.replace('api/', '');\n    host = host.replace(':3008', '');\n    console.log(host)\n    window.open(`${host}p/${page.url}`, '_blank');\n  }\n  onEdit(id) {\n    this.props.history.push(`/edit/${id}`);\n  }\n  onHtmlEdit(id) {\n    this.props.history.push(`/new-builder/${id}`);\n  }\n  onDelete(item) {\n    swal({\n      title: \"Are you sure?\",\n      text: \"Once deleted, you will not be able to recover this page!\",\n      icon: \"warning\",\n      buttons: true,\n      dangerMode: true,\n    })\n      .then(willDelete => {\n        if (willDelete)\n          Axios.delete(`admin/page/page/${item.id}`).then(r => {\n            console.log(r)\n            var { list } = this.state;\n            list = list.filter(page => page.id !== item.id);\n            this.setState({ list: list })\n          })\n      })\n\n  }\n  onDownload(page){\n    var host = REACT_APP_BASE_URL.replace('api/', '');\n    host = host.replace(':3008', '');\n    console.log(host)\n    window.open(`${REACT_APP_BASE_URL}/admin/page/download-zip?page_id=${page.id}`, '_blank');\n  }\n  onDuplicate(item) {\n    try {\n      item = JSON.parse(JSON.stringify(item))\n      delete item.id\n      item.url = 'Copy ' + new Date().getTime() + item.url;\n\n      Axios.post('admin/page/add-page', item).then(r => {\n        console.log(r)\n        this.props.history.push(`/edit/${r.data.id}`);\n      })\n    } catch (e) {\n      console.log(e)\n    }\n  }\n  render() {\n    var { list } = this.state;\n    return (\n      <>\n        <CRow>\n          <CCol>\n            <CCard>\n              <CCardHeader>\n                Page List\n                <div className=\"card-header-actions\">\n                  <CButton type=\"submit\" size=\"sm\" color=\"danger\" onClick={() => { this.onExport() }} className=\"mr-2\"><CIcon name=\"cil-scrubber\" /> Export</CButton>\n                </div>\n              </CCardHeader>\n              <CCardBody>\n\n                <CButton type=\"submit\" size=\"sm\" color=\"warning\" onClick={() => { this.props.history.push('/new'); }}><CIcon name=\"cil-scrubber\" />Add</CButton>\n\n                <br />\n\n                <table className=\"table table-outline mb-0 d-none d-sm-table\">\n                  <thead className=\"thead-light\">\n                    <tr>\n                      <th>Name</th>\n                      <th className=\"text-center\">Visit Number</th>\n                      <th className=\"text-center\">Assigened User</th>\n                      {/* <th className=\"text-center\">Preview</th> */}\n                      <th className=\"text-right\">View</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {list.map(page => {\n                      var date = moment(new Date(page.createdAt)).format('DD MMMM YYYY')\n                      return <tr key={page.id}>\n\n                        <td>\n                          <div>{page.title}</div>\n                          <div className=\"small text-muted\">\n                            {page.visit === 0 ? <><span className=\"text-success\">New</span> | </> : null} Created: {date}\n                          </div>\n                        </td>\n\n                        <td className=\"text-center\">{page.visit}</td>\n                        <td className=\"text-center\">{page.page_users != null && page.page_users.length}</td>\n                        {/* <td className=\"text-center\"><div dangerouslySetInnerHTML={{ __html: page.html }}></div></td> */}\n                        <td className=\"text-right\">\n                          <CButton color=\"primary\" size=\"sm\" className=\"\" variant=\"outline\" onClick={() => this.onVisit(page)}>Visit</CButton>\n                          <CButton color=\"success\" size=\"sm\" className=\"ml-1\" variant=\"outline\" onClick={() => this.onView(page.id)}>View</CButton>\n                          <CButton color=\"success\" size=\"sm\" className=\"ml-1\" variant=\"outline\" onClick={() => this.onDownload(page)}>Download</CButton>\n                          <CButton color=\"primary\" size=\"sm\" className=\"ml-1\" variant=\"outline\" onClick={() => this.onEdit(page.id)}>Edit</CButton>\n                          <CButton color=\"primary\" size=\"sm\" className=\"ml-1\" variant=\"outline\" onClick={() => this.onHtmlEdit(page.id)}>Html Builder</CButton>\n                          <CButton color=\"danger\" size=\"sm\" className=\"ml-1\" variant=\"outline\" onClick={() => this.onDelete(page)}>Delete</CButton>\n                          <CButton color=\"info\" size=\"sm\" className=\"ml-1\" variant=\"outline\" onClick={() => this.onDuplicate(page)}>Duplicate</CButton>\n                        </td>\n                      </tr>\n\n                    })}\n\n                  </tbody>\n                </table>\n\n              </CCardBody>\n            </CCard>\n          </CCol>\n        </CRow>\n      </>\n    )\n  }\n}\n\nexport default PageList\n"],"sourceRoot":""}